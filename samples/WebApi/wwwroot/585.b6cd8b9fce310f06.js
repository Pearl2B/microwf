"use strict";(self.webpackChunkwebclient=self.webpackChunkwebclient||[]).push([[585],{9585:(R,p,o)=>{o.r(p),o.d(p,{IssueModule:()=>$});var d=o(6895),l=o(5699),v=o(9116),I=o(5202),c=o(337),T=o(709),e=o(5062),A=o(7165);let g=(()=>{class i{constructor(t){this._http=t}assignees(){return this._http.get("issue/assignees")}myWork(){return this._http.get("issue/mywork")}create(){return this._http.post("issue/new",null)}save(t){return this._http.post("issue",t)}get(t){return this._http.get(`issue/${t}`)}process(t){return this._http.post("issue/process",t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(A.O))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var m=o(655),S=o(5570),M=o(5370),_=o(453);const C=function(i){return["detail",i]};function w(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p")(3,"b"),e.SDv(4,13),e.qZA(),e.TgZ(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"div",14)(8,"p")(9,"b"),e.SDv(10,15),e.qZA(),e.TgZ(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"p")(14,"b"),e.SDv(15,16),e.qZA(),e.TgZ(16,"span"),e._uU(17),e.qZA()()()()()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(4,C,null==t?null:t.id)),e.xp6(5),e.hij(" ",null==t?null:t.title,""),e.xp6(6),e.hij(" ",null==t?null:t.state,""),e.xp6(5),e.hij(" ",null==t?null:t.assignee,"")}}const E=function(){return["detail/new"]};let u=class{constructor(s,t){this._router=s,this._service=t,this.workspace="pane"}ngOnInit(){this.myWork$=this._service.myWork()}create(){this._router.navigate(["./detail/new"])}reload(){this.ngOnInit()}};u.\u0275fac=function(s){return new(s||u)(e.Y36(l.F0),e.Y36(g))},u.\u0275cmp=e.Xpm({type:u,selectors:[["tw-issue-dashboard"]],hostVars:2,hostBindings:function(s,t){2&s&&e.Tol(t.workspace)},features:[e._Bn([g])],decls:15,vars:5,consts:function(){let i,s,t,n;return i=$localize`:␟66db799d67958d4b0765181d072df62e2d1c16f5␟1176990449799757498:Issues`,s=$localize`:␟8737210008395d7b014e5118d2ed198ae9745215␟2517309683610083249:Title:`,t=$localize`:␟caeaea23981b9730ff04e00174619919105e94a5␟416077535002182849:State:`,n=$localize`:␟cb1b286d9e2e10db8f3ee4d22b535943b61b0a02␟3997253702608180743:Assignee:`,[[1,"pane__left"],[3,"rows"],["list",""],i,[1,"button__bar"],[1,"button",3,"routerLink"],["name","plus"],["type","button",3,"click"],["name","refresh"],["twTemplate","issue-item"],[1,"pane__main"],[1,"list__item"],["routerLinkActive","active",3,"routerLink"],s,[1,"list__itemDetail"],t,n]},template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"tw-list",1,2),e.ALo(3,"async"),e.TgZ(4,"tw-header")(5,"h3"),e.SDv(6,3),e.qZA(),e.TgZ(7,"div",4)(8,"a",5),e._UZ(9,"tw-icon",6),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return t.reload()}),e._UZ(11,"tw-icon",8),e.qZA()()(),e.YNc(12,w,18,6,"ng-template",9),e.qZA()(),e.TgZ(13,"div",10),e._UZ(14,"router-outlet"),e.qZA()),2&s&&(e.xp6(1),e.Q6J("rows",e.lcZ(3,2,t.myWork$)),e.xp6(7),e.Q6J("routerLink",e.DdM(4,E)))},dependencies:[l.lC,l.rH,l.yS,l.Od,M.o,_.ns,_.Gt,_.VC,d.Ov],encapsulation:2}),u=(0,m.gn)([S.k],u);let h=(()=>{class i{constructor(t){this.key=i.KEY,this.type=c.AF,this.title="",t.map(r=>({key:r,value:r})),this.editors=[{key:"id",type:c.md,label:"Id",required:!1},{key:"title",type:c.P8,label:"Message",required:!0,minLength:3,maxLength:140},{key:"description",type:c.N5,label:"Description",required:!1,maxLength:500}]}}return i.KEY="issuedetailslot",i})();var y=o(8613),b=o(5108),N=o(1803);const D=["formDef"];function O(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tw-trigger-info",3),e.NdJ("trigger",function(r){e.CHM(t);const f=e.oxw();return e.KtG(f.triggerClicked(r))}),e.qZA()}if(2&i){const t=e.oxw(),n=e.MAs(4);e.Q6J("canTrigger",n.formIsValid)("triggerInfo",t.triggerInfo)}}let a=class{constructor(s,t,n,r,f){this._route=s,this._router=t,this._user=n,this._service=r,this._slotRegistry=f,this.key=h.KEY,this.canTrigger=!1,this.isNew=!1}ngOnInit(){this._routeParams$=this._route.params.subscribe(s=>{s.id&&this.init(s.id)})}submitted(s){this._issue$=this._service.save(s).subscribe(t=>{t>0&&this.back()})}cancel(){this.back()}triggerClicked(s){this._issue$=this._service.process({id:this.viewModel.id,trigger:s,assignee:this.viewModel.assignee,title:this.viewModel.title,description:this.viewModel.description}).subscribe(n=>{n.triggerInfo.succeeded&&n.viewModel.assignee!==this._user.userName?this._router.navigate(["dispatch",n.viewModel.assignee,"issue"]):(this.viewModel=n.entity,this.triggerInfo=n.triggerInfo,this.entity=n.entity)})}back(){this._router.navigate(["issue"])}init(s){this._assignees$=this._service.assignees().subscribe(t=>{this._slotRegistry.register(new h(t)),"new"!==s?this.load(s.toString()):this.create()})}load(s){this._issue$=this._service.get(s).subscribe(t=>{this.key=h.KEY,this.viewModel=t.viewModel,this.triggerInfo=t.triggerInfo,this.entity=t.entity})}create(){this._issue$=this._service.create().subscribe(s=>{this.viewModel=s.viewModel,this.triggerInfo=s.triggerInfo,this.entity=s.entity,this.isNew=!0})}};a.\u0275fac=function(s){return new(s||a)(e.Y36(l.gz),e.Y36(l.F0),e.Y36(y.K),e.Y36(g),e.Y36(c.FR))},a.\u0275cmp=e.Xpm({type:a,selectors:[["tw-issue"]],viewQuery:function(s,t){if(1&s&&e.Gf(D,5),2&s){let n;e.iGM(n=e.CRH())&&(t.formDef=n.first)}},features:[e._Bn([g])],decls:5,vars:5,consts:[[3,"canTrigger","triggerInfo","trigger",4,"ngIf"],[3,"showSave","showCancel","key","viewModel","submitted","resetted"],["formDef",""],[3,"canTrigger","triggerInfo","trigger"]],template:function(s,t){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,O,1,2,"tw-trigger-info",0),e.qZA(),e.TgZ(2,"div")(3,"tw-formdef",1,2),e.NdJ("submitted",function(r){return t.submitted(r)})("resetted",function(){return t.cancel()}),e.qZA()()),2&s){const n=e.MAs(4);e.xp6(1),e.Q6J("ngIf",!t.isNew&&n),e.xp6(2),e.Q6J("showSave",t.isNew)("showCancel",t.isNew)("key",t.key)("viewModel",t.viewModel)}},dependencies:[d.O5,b.w,N.S],encapsulation:2}),a=(0,m.gn)([S.k],a);const Z=[{path:"",component:u,children:[{path:"detail/:id",component:a},{path:"detail/new",component:a}]}];let $=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[g],imports:[d.ez,l.Bz.forChild(Z),c.eO,T.L,v.Q,I.p,l.Bz]}),i})()}}]);